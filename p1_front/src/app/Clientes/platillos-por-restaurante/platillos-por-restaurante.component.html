<app-header />



<div class="card flex justify-center mb-2">
  <p-fieldset legend="Gestion de Platillos">
    <p class="m-0">
      Para crear una nuevo platillo haga click en el boton
    </p>
    <p-button label="Nuevo Platillo" class="w-full" styleClass="w-full" (onClick)="this.verDialogoNuevaHabitacion()" />
  </p-fieldset>
</div>
<!-- Panel LISTADO -->
<div class="h-full w-full mb-2">
  <div style="
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            padding: 1rem;
          ">
    @for (item of this.paginatedItems; track $index) {
    <p-card [style]="{
                width: '100%',
                overflow: 'hidden',
                borderRadius: '1rem',
                boxShadow: '0 4px 12px rgba(0,0,0,0.08)'
              }">

      <ng-template #title>
        <span style="font-weight: 600;"> {{ item.nombre }}</span>
      </ng-template>
      <ng-template #subtitle>
        <span style="color: #6b7280;">{{ item.precio | currency:'GTQ':'symbol':'1.2-2' }}</span>
      </ng-template>
      <p-tag severity="info" value="{{item.tipo}}" />

      <div class="card flex justify-center">
        <p-rating [(ngModel)]="item.promedio_valoracion" [readonly]="true"></p-rating>

      </div>

      <ng-template #footer>
        <div class="flex gap-4 mt-1">
          <p-button label="Ver comentarios" class="w-full" styleClass="w-full" (click)="showDialog(item.id)" />
          <p-button label="Comprar" class="w-full" styleClass="w-full"
            />
        </div>
      </ng-template>
    </p-card>
    }
  </div>

        <!-- paginator -->
        <div style="margin-top: 1rem; display: flex; justify-content: center;">
          <p-paginator
            [first]="first"
            [rows]="rows"
            [totalRecords]="items.length"
            [rowsPerPageOptions]="[3, 6, 10]"
          />
        </div>
</div>


<!-- comentarios en una habitacion-->
<div class="card flex justify-center">
  <p-dialog header="Comentarios" [modal]="true" [(visible)]="visible" [style]="{ width: '25rem' }">
    <div class="card flex justify-content-center">
      <p-accordion value="0">
        @for (item of this.listadoComentarios; track $index) {
        <p-accordion-panel value="$index">
          <p-accordion-header>
            <ng-template #toggleicon let-active="active">
              @if (active) {
              <i class="pi pi-minus"></i>
              } @else {
              <i class="pi pi-plus"></i>
              }
            </ng-template>
            <span class="flex items-center gap-2 w-full">
              <span class="font-bold whitespace-nowrap">Comentario No.{{$index}}</span>
              <p-badge value="{{item.puntuacion}}" class="ml-auto mr-2" />
            </span>
          </p-accordion-header>
          <p-accordion-content>
            <p class="m-0">
              {{item.comentario}}
            </p>
          </p-accordion-content>
        </p-accordion-panel>
        }



      </p-accordion>
    </div>
  </p-dialog>
</div>


<!-- para nuevas habitaciones-->

<div class="card flex justify-center">
  <p-dialog 
      header="Nuevo Platillo" 
      [modal]="true" 
      [(visible)]="visibleNuevoPlatillo" 
      [style]="{ width: '30rem' }"
  >

      <div class="flex items-center gap-4 mb-3">
        <label for="Nombre" class="font-semibold w-32">Nombre</label>
        <input 
          pInputText 
          id="nombre" 
          class="flex-auto border border-gray-400 rounded px-2 py-1 focus:border-blue-500 focus:outline-none" 
          type="text"
          [(ngModel)] =this.nombre
        />
      </div>

      <!-- Precio -->
      <div class="flex items-center gap-4 mb-4">
        <label for="precio" class="font-semibold w-32">Precio</label>
        <input 
          pInputText 
          id="precio" 
          class="flex-auto border border-gray-400 rounded px-2 py-1 focus:border-blue-500 focus:outline-none" 
          type="number" 
          [(ngModel)] =this.precio
        [min]="0"
          step="0.01"
        />
      </div>


      <div class="flex items-center gap-4 mb-3">
        <label for="tipoHabitacion" class="font-semibold w-32">Tipo Platillo</label>
        <p-select 
          [options]="this.tipoPlatillos" 
          optionLabel="label" 
          placeholder="Selecciona tipo" 
          class="flex-auto border border-gray-400 rounded px-2 py-1"
          [(ngModel)] =this.tipoPlatillo

        >
        </p-select>
      </div>



      <!-- Botones -->
      <div class="flex justify-end gap-2 mt-4">
        <p-button 
          label="Cancelar" 
          severity="secondary" 
          (click)="visibleNuevoPlatillo = false" 
        />
        <p-button 
          label="Guardar" 
          (click)="guardarHabitacion()" 
        />
      </div>

  </p-dialog>
</div>

