<app-header />


<!-- como header para ingresar nuevas habitaciones-->

<div class="card flex justify-center mb-2">
  <p-fieldset legend="Gestion de Habitacion">
    <p class="m-0">
      Para crear una nueva habitacion haga click en el boton
    </p>
    <p-button label="Nueva habitacion" class="w-full" styleClass="w-full" (onClick)="this.verDialogoNuevaHabitacion()" />
  </p-fieldset>
</div>
<!-- Panel LISTADO -->
<div class="h-full w-full mb-2">
  <div style="
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            padding: 1rem;
          ">
    @for (item of this.listadoHabitaciones; track $index) {
    <p-card [style]="{
                width: '100%',
                overflow: 'hidden',
                borderRadius: '1rem',
                boxShadow: '0 4px 12px rgba(0,0,0,0.08)'
              }">

      <ng-template #title>
        <span style="font-weight: 600;">Habitacion No. {{ item.numero_habitacion }}</span>
      </ng-template>
      <ng-template #subtitle>
        <span style="color: #6b7280;">{{ item.direccion }}</span>
      </ng-template>
      <p style="color: #374151; margin: 0.5rem 0;">Cantidad de camas {{ item.cantidad_camas }}</p>
      <p style="color: #374151; margin: 0.5rem 0;">Precio {{ item.precio | currency:'GTQ':'symbol':'1.2-2' }}</p>

      <div class="card flex justify-center">
        <p-rating [(ngModel)]="item.promedio_valoracion" [readonly]="true"></p-rating>

      </div>

      <ng-template #footer>
        <div class="flex gap-4 mt-1">
          <p-button label="Ver comentarios" class="w-full" styleClass="w-full" (click)="showDialog(item.id)" />
          <p-button label="Reservar habitacion" class="w-full" styleClass="w-full"
            [routerLink]="['/hotel_restaurante/hotel/',item.id]" />
        </div>
      </ng-template>
    </p-card>
    }
  </div>

  <!-- paginator
        <div style="margin-top: 1rem; display: flex; justify-content: center;">
          <p-paginator
            [first]="first"
            [rows]="rows"
            [totalRecords]="items.length"
            [rowsPerPageOptions]="[3, 6, 10]"
          />
        </div> -->
</div>


<!-- comentarios en una habitacion-->
<div class="card flex justify-center">
  <p-dialog header="Comentarios" [modal]="true" [(visible)]="visible" [style]="{ width: '25rem' }">
    <div class="card flex justify-content-center">
      <p-accordion value="0">
        @for (item of this.listadoComentarios; track $index) {
        <p-accordion-panel value="$index">
          <p-accordion-header>
            <ng-template #toggleicon let-active="active">
              @if (active) {
              <i class="pi pi-minus"></i>
              } @else {
              <i class="pi pi-plus"></i>
              }
            </ng-template>
            <span class="flex items-center gap-2 w-full">
              <span class="font-bold whitespace-nowrap">Comentario No.{{$index}}</span>
              <p-badge value="{{item.puntuacion}}" class="ml-auto mr-2" />
            </span>
          </p-accordion-header>
          <p-accordion-content>
            <p class="m-0">
              {{item.comentario}}
            </p>
          </p-accordion-content>
        </p-accordion-panel>
        }



      </p-accordion>
    </div>
  </p-dialog>
</div>


<!-- para nuevas habitaciones-->

<div class="card flex justify-center">
  <p-dialog 
      header="Nueva Habitación" 
      [modal]="true" 
      [(visible)]="visibleNuevaHabitacion" 
      [style]="{ width: '30rem' }"
  >

      <!-- Número de habitación -->
      <div class="flex items-center gap-4 mb-3">
        <label for="numero_habitacion" class="font-semibold w-32">Número Habitación</label>
        <input 
          pInputText 
          id="numero_habitacion" 
          class="flex-auto border border-gray-400 rounded px-2 py-1 focus:border-blue-500 focus:outline-none" 
          type="number"
          [(ngModel)] =this.numeroHabitacion
        />
      </div>

      <!-- Cantidad de camas -->
      <div class="flex items-center gap-4 mb-3">
        <label for="cantidad_camas" class="font-semibold w-32">Cantidad Camas</label>
        <input 
          pInputText 
          id="cantidad_camas" 
          class="flex-auto border border-gray-400 rounded px-2 py-1 focus:border-blue-500 focus:outline-none" 
          type="number"
          [(ngModel)] =this.cantidad_camas

        />
      </div>

      <!-- ID del hotel -->
      <div class="flex items-center gap-4 mb-3">
        <label for="id_hotel" class="font-semibold w-32">ID Hotel</label>
        <input 
          pInputText 
          id="id_hotel" 
          class="flex-auto border border-gray-400 rounded px-2 py-1 focus:border-blue-500 focus:outline-none" 
          type="number"
          [(ngModel)] =this.hotel

        />
      </div>

      <!-- Tipo de habitación -->
      <div class="flex items-center gap-4 mb-3">
        <label for="tipoHabitacion" class="font-semibold w-32">Tipo Habitación</label>
        <p-select 
          [options]="this.tiposHabitacion" 
          optionLabel="label" 
          placeholder="Selecciona tipo" 
          class="flex-auto border border-gray-400 rounded px-2 py-1"
          [(ngModel)] =this.tipoHabitacion

        >
        </p-select>
      </div>

      <!-- Precio -->
      <div class="flex items-center gap-4 mb-4">
        <label for="precio" class="font-semibold w-32">Precio</label>
        <input 
          pInputText 
          id="precio" 
          class="flex-auto border border-gray-400 rounded px-2 py-1 focus:border-blue-500 focus:outline-none" 
          type="number" 
          [(ngModel)] =this.precio

          step="0.01"
        />
      </div>

      <!-- Botones -->
      <div class="flex justify-end gap-2 mt-4">
        <p-button 
          label="Cancelar" 
          severity="secondary" 
          (click)="visibleNuevaHabitacion = false" 
        />
        <p-button 
          label="Guardar" 
          (click)="guardarHabitacion()" 
        />
      </div>

  </p-dialog>
</div>

